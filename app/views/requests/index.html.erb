<% provide(:title, 'Requests') %>

<h1>Open requests</h1>

<% if current_user.admin? %>
  <% unless params[:past] %>
    <h1>Current requests</h1>
    <%= link_to "Show past requests", past: true %>
  <% else %>
    <h1>Past requests</h1>
    <%= link_to "Show current requests" %>
  <% end%>
<% end %>


<div>
  <% if @requests.any? %>
    <h2>Requests in want of an offer</h2>
    <ul class="requests">
      <% @requests.each do |req| %>
        <li>
          <%= link_to req, req %>
          <% if current_user_can_edit?(req) %>
            [<%= link_to "Edit", edit_request_path(req) %>]
            [<%= link_to "Delete", req, method: :delete, 
                        data: { confirm: "Really delete this request?" } %>]
          <% end %>
          <%= "[fulfilled]" if req.fulfilled? %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>There don't appear to be any matching requests</p>
  <% end %>
</div>
